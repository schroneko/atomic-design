'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.addonComposer = addonComposer;
exports.userComposer = userComposer;

var _store = require('./store');

function addonComposer(storeHandler, Component) {
    /** note: addonComposer
     *  storeHandler(storeData, props, addonApi)
     *  Component - ReactJS <Component />
     *  currentStoreCompose - will be attached in decorator
     */

    return function composeLinker(env) {
        var currentStoreCompose = (0, _store.getStoreCompose)(env);

        var dataLoader = function dataLoader(props, onData, env) {
            var addonStore = env.addonStore;
            var addonApi = env.apiMap;
            var storybookApi = env.storybookApi;
            var sendData = function sendData(storeData) {
                var handledData = storeHandler(storeData, props, addonApi, storybookApi);
                onData(null, handledData);
            };

            var stopSubscription = addonStore.subscribe(sendData);
            sendData(addonStore.getAll());
            return stopSubscription;
        };

        return currentStoreCompose(dataLoader)(Component);
    };
}

function userComposer() {
    return null;
}